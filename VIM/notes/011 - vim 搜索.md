
参考：`/usr/share/vim/vim[0-9][0-9]/doc/change.txt`

## f,F 搜索字符

指令                 | 说明
--------------------|------------------------
`t{char}`           | Till **before** [count]'th occurrence of {char} to right.
`T{char}`           | Till **before** [count]'th occurrence of {char} to left.
`f{char}`           | To [count]'th occurrence of {char} to the right.
`F{char}`           | To the [count]'th occurrence of {char}  to the left.
`;`                 | Repeat latest f, t, F or T [count] times.
`,`                 | Repeat latest f, t, F or T in **opposite** direction [count] times.

> 对应帮助文档：motion.txt

## /,? 搜索查找

命令                | 说明            | 备注
--------------------|----------------|--------
`/phrase `          | searches FORWARD for the phrase  | `\c`可以忽略大小写（ignore case），`\C`则区分大小写
`?phrase `          | searches BACKWARD for the phrase | `\c`可以忽略大小写（ignore case），`\C`则区分大小写
`n`                 | to find the next occurrence in the same direction | `/`一直向下查找；`?`一直向上查找。
`N`                 | to search in the opposite direction               | `/`向上查找；`?`向下查找。
`*`                 | search forward                                    | 向下查找当前光标所在单词
`#`                 | search backward                                   | 向上查找当前光标所在单词

在 `/` 或 `?` 后输入搜索关键字后，按下回车键确认开始搜索，然后按下 <kbd>n</kbd>/<kbd>N</kbd> 查找下/上一个。

> 对应帮助文档：pattern.txt，帮助命令 `:h regexp` 或 `:h vimgrep`。

参考 [**VI**(1P)](http://man7.org/linux/man-pages/man1/vi.1p.html) 的 **EXTENDED DESCRIPTION** 的以下章节：

- Find Regular Expression（Synopsis: `/`）  
- Scan Backwards for Regular Expression（Synopsis: `?`）  
- Repeat Regular Expression Find (Forward)（Synopsis: `n`）  
- Repeat Regular Expression Find (Reverse)（Synopsis: `N`）  

### [如何去掉当次搜索高亮？](http://forum.ubuntu.org.cn/viewtopic.php?p=815643)

> 方法一：`:noh` 或 `:nohl` 或 `:nohls` 或 `:nohlsearch`  
> 方法二：/awertgvcxz，查找一个根本不存在的字符串，消除高亮  

### [incsearch](http://www.vim.org/scripts/script.php?script_id=5038)
[`incsearch.vim`](https://github.com/haya14busa/incsearch.vim) incrementally highlights ALL pattern matches unlike default 'incsearch'.

## :s 查找替换（THE SUBSTITUTE COMMAND）

按键                | 说明
--------------------|------------------------
`:s/old/new`        | only changes the **first** occurrence of "old" in the line.
`:s/old/new/g`      | Adding the `g` flag means to substitute **globally** in the line, <br/>change all occurrences of "old" in the line.
`:#,#s/old/new/g`   | where #,# are the *line numbers* of the **range** of lines <br/>where the substitution is to be done.
`:%s/old/new/g`     | to change every occurrence in the ***whole file***.
`:%s/old/new/gc`    | to find every occurrence in the ***whole file***, with a *prompt* whether to substitute or not.

- **`/g`** 尾缀（suffix）代表对行内所有匹配都执行（替换）操作；  
- `/c` 尾缀（suffix）代表执行操作前弹出确认（confirm prompt）；  
- **`%`** 前缀（prefix）代表针对被编辑文件的所有行都执行后续操作；  

> 对应帮助文档：change.txt

```shell
[i]     Ignore case for the pattern.
[I]     Don't ignore case for the pattern.
```

可以参考分析帮助文档中的示例：

```shell
Examples: >
# \0: replaced with the whole matched pattern
  :s/a\|b/xxx\0xxx/g             modifies "a b"      to "xxxaxxx xxxbxxx"

  :s/\([abc]\)\([efg]\)/\2\1/g   modifies "af fa bg" to "fa fa gb"

# 中间插入换行符，相当于切割分行
  :s/abcde/abc^Mde/              modifies "abcde"    to "abc", "de" (two lines)

# 转义为原始符号，只是在当前行末添加两个字符(^M)
  :s/$/\^M/                      modifies "abcde"    to "abcde^M"


  :s/\w\+/\u\0/g                 modifies "bla bla"  to "Bla Bla"
  :s/\w\+/\L\u\0/g               modifies "BLA bla"  to "Bla Bla"

command         text    result ~
:s/aa/a^Ma/     aa      a<line-break>a
:s/aa/a\^Ma/    aa      a^Ma
:s/aa/a\\^Ma/   aa      a\<line-break>a

(you need to type CTRL-V <CR> to get a ^M here)

```

### 示例
> [VIM多行注释/反注释](http://blog.csdn.net/xufeng0991/article/details/50201561)  
> [vim多行注释和取消注释](http://www.cnblogs.com/Ph-one/p/5641872.html)  
> [vim行首加入某字符](http://blog.csdn.net/xxxxxx91116/article/details/7960097)  
> [vi/vim 中如何在每行行首或行尾插入指定字符串](http://www.cnblogs.com/Dennis-mi/articles/5939635.html)  

1. 在所有行首添加注释符号（//）：  

`:%s/^/\/\//g`  
`:%s#^#//#g`（用 `#` 或 `+` 代替 `/`，old 或 new 中的 `/` 不用转义）  

> 说明：行首（old=`^`）替换为注释符号（new=`//`）。  
>> 若将 `^` 替换为 `$` 则针对行尾操作。  

2. 为 20~50 行首添加注释符号（//）：  

`:20,50 s/^/\/\//g`  
`:20,50s#^#//#g`  

> 在 markdown 文档的 143~145这3行首插入 `- `，使之成为 Unordered List：`143,145s#^#- #`  
>> 如果是行尾的话，将 `^` 换成 `$`。  

3. 为 20~50 行首移除注释符号（//）：

`:20,50 s/^\/\///g`  
`:20,50s#^//##g`  

> 行首的注释符号（old=`^//`）替换为空（new=空），相当于删除。  

4. 将空行删除：

`:1,$s/^$\n//g`

> 将首行到末行（全文）中内容为换行符（old=`^$\n`）的空行替换为空（new=空），相当于移除空行。  

`:%s/\n//g`：删除换行符；  
`:%s/\r//g`：删除DOS文件中的回车符`^M`；  

## 查找过滤包含关键字的行（filter lines）
> [Show only matching lines?](https://vi.stackexchange.com/questions/2280/show-only-matching-lines)  
> [How to filter text matched by global command?](https://vi.stackexchange.com/questions/10860/how-to-filter-text-matched-by-global-command)  

在 vim 中输入 `:g/{pattern}` 命令可列出所有匹配关键字 `{pattern}` 的行。  

> `:[range]g[lobal]/{pattern}/[cmd]`  

执行 `:g/{pattern}/m0` 或 `:g/{pattern}/m$` 跳转到第一个或最后一个匹配行。  

---

除了执行的 global pattern match 之外，也可执行 **vimgrep** 命令执行高级查找过滤。

1. 执行以下命令查找整个文件内的关键字 `{pattern}`：

	> `:vimgrep {pattern} %`

2. 执行 `:cwin` 打开查找结果 buffer。在其中可使用上下方向键或<kbd>j</kbd><kbd>k</kbd>定位，按下<kbd>enter</kbd>键跳转到原文匹配行。  

3. 执行 `:sav filterlines.txt` 可将结果 buffer 保存到指定文件（filterlines.txt）中。  
